"use strict";(self.webpackChunklite=self.webpackChunklite||[]).push([[3624],{48088:(e,n,i)=>{i.d(n,{h:()=>F});var a=i(64467),l=i(80296),t=i(55364),d=i.n(t),r=i(95420),u=i(96540),s=i(11321),o=i(21335),m=i(87509),k=i(49287),c=i(91830),v={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"useNewsletterV3Subscription_user"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"username"}},{kind:"Field",name:{kind:"Name",value:"newsletterV3"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"useNewsletterV3Subscription_newsletterV3"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"useNewsletterV3Subscription_newsletterV3"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NewsletterV3"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"slug"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"collection"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"slug"}}]}},{kind:"Field",name:{kind:"Name",value:"user"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"username"}},{kind:"Field",name:{kind:"Name",value:"newsletterV3"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]},N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SubscribeNewsletterV3Mutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"newsletterV3Id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shouldRecordConsent"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subscribeNewsletterV3"},arguments:[{kind:"Argument",name:{kind:"Name",value:"newsletterV3Id"},value:{kind:"Variable",name:{kind:"Name",value:"newsletterV3Id"}}},{kind:"Argument",name:{kind:"Name",value:"shouldRecordConsent"},value:{kind:"Variable",name:{kind:"Name",value:"shouldRecordConsent"}}}]}]}}]},b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UnsubscribeNewsletterV3Mutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"newsletterV3Id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"unsubscribeNewsletterV3"},arguments:[{kind:"Argument",name:{kind:"Name",value:"newsletterV3Id"},value:{kind:"Variable",name:{kind:"Name",value:"newsletterV3Id"}}}]}]}}]},S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"FetchOrLazilyCreateNewsletterV3AndMaybeSubscribeMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"useNewsletterV3Subscription_newsletterV3"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"useNewsletterV3Subscription_newsletterV3"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NewsletterV3"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"slug"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"collection"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"slug"}}]}},{kind:"Field",name:{kind:"Name",value:"user"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"username"}},{kind:"Field",name:{kind:"Name",value:"newsletterV3"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]},w=i(21800),p=i(80452),g=i(2550),V=i(99766);function f(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,a)}return i}function y(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?f(Object(i),!0).forEach((function(n){(0,a.A)(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}var F=function(e){var n=e.newsletterV3,i=e.creator,a=e.newsletterName,t=e.hideLinkInConfirmationToast,f=void 0!==t&&t,F=n||{},D=F.id,I=F.type,h=F.slug,C=F.collection,E=(null==n?void 0:n.user)||i,T=null!=a?a:null==n?void 0:n.name,O=(0,g.A)().viewerId,A=(0,o.cd)(null==E?void 0:E.id),L=A.viewerEdge,j=A.loading,M=(0,p.h)(),_=u.useState(!1),P=(0,l.A)(_,2),x=P[0],R=P[1],B=(0,s.h)({newsletterSlug:h,collectionSlug:null==C?void 0:C.slug,username:null==E?void 0:E.username}),U=B.viewerEdge,z=B.loading,q=u.useState(!1),G=(0,l.A)(q,2),Q=G[0],Z=G[1];u.useEffect((function(){Z(!(null==U||!U.isSubscribed))}),[null==U?void 0:U.isSubscribed]);var W=(0,m.$L)(),X=(0,k.jI)(),Y=(0,c.zF)();x&&W.event("newsletterV3.subscribe.error",{newsletterV3Id:D});var $=function(e,n,i){if(i){var a={id:"User:".concat(null==E?void 0:E.id),fragment:v,fragmentName:"useNewsletterV3Subscription_user"},l=e.readFragment(a);l&&e.writeFragment(y(y({},a),{},{data:y(y({},l),{},{newsletterV3:i})}))}if(U){var t=e.readQuery({query:V.k,variables:{newsletterSlug:h||"",collectionSlug:(null==C?void 0:C.slug)||null,username:(null==E?void 0:E.username)||null}}),r=d()({},t,{newsletterV3:{viewerEdge:{isSubscribed:n}}});e.writeQuery({query:V.k,variables:{newsletterSlug:h||"",collectionSlug:(null==C?void 0:C.slug)||null,username:(null==E?void 0:E.username)||null},data:r})}if(n&&null!=E&&E.id&&(null==L||!L.isFollowing)){var u=E.id;(0,w.M)({cache:e,userId:u,viewerId:O}),(0,o.YG)(e,u,{isFollowing:!0})}},H=(0,u.useCallback)((function(e){W.event("newsletterV3.subscribeClicked",{newsletterV3Id:e,source:X}),null!=L&&L.isFollowing||null==E||!E.id||M("user.followed",{targetUserId:E.id})}),[X,W,null==L?void 0:L.isFollowing,null==E?void 0:E.id,M]),J=(0,u.useCallback)((function(e){return function(n){var i=n.subscribeNewsletterV3;R(!i),i&&(H(D),e&&e(),Z(!0))}}),[X,D,H]),K=(0,r.n)(N,{optimisticResponse:{subscribeNewsletterV3:!0},update:function(e){$(e,!0)}}),ee=(0,l.A)(K,1)[0],ne=(0,u.useCallback)((function(e){return function(n){var i=n.unsubscribeNewsletterV3;R(!i),i&&(W.event("newsletterV3.unsubscribeClicked",{newsletterV3Id:D,source:X}),Z(!1),e?e():Y({duration:f?5e3:"NEXTPAGE",toastStyle:"NEWSLETTER_UNSUBSCRIBE",extraParams:{newsletterName:T||null,newsletterType:I||null,unsubscribeFn:function(){return Z(!1)},hideEmailSettingsLink:f,hideCloseButton:f}}))}}),[X,D,f,T,I]),ie=(0,r.n)(b,{optimisticResponse:{unsubscribeNewsletterV3:!0},update:function(e){$(e,!1)}}),ae=(0,l.A)(ie,1)[0],le=(0,u.useCallback)((function(e){return function(n){var i=n.fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe;R(!i),i&&(H(i.id),e&&e(),Z(!0))}}),[X,H]),te=(0,r.n)(S,{update:function(e,n){var i,a=y({},null===(i=n.data)||void 0===i?void 0:i.fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe);$(e,!0,a)}}),de=(0,l.A)(te,1)[0];return{isSubscribed:Q,hasError:x,setSubscribe:function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2?arguments[2]:void 0;R(!1),e&&!n&&null!=i&&i.id?de({variables:{userId:null==i?void 0:i.id},onCompleted:le(l)}):e&&null!=n&&n.id?ee({variables:{newsletterV3Id:null==n?void 0:n.id,shouldRecordConsent:a},onCompleted:J(l)}):null!=n&&n.id?ae({variables:{newsletterV3Id:null==n?void 0:n.id},onCompleted:ne(l)}):R(!0)},loading:z||j}}},99766:(e,n,i)=>{i.d(n,{k:()=>a});var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"NewsletterV3ViewerEdge"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"newsletterSlug"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"collectionSlug"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"username"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"newsletterV3"},arguments:[{kind:"Argument",name:{kind:"Name",value:"newsletterSlug"},value:{kind:"Variable",name:{kind:"Name",value:"newsletterSlug"}}},{kind:"Argument",name:{kind:"Name",value:"collectionSlug"},value:{kind:"Variable",name:{kind:"Name",value:"collectionSlug"}}},{kind:"Argument",name:{kind:"Name",value:"username"},value:{kind:"Variable",name:{kind:"Name",value:"username"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NewsletterV3"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"viewerEdge"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"NewsletterV3ViewerEdge_newsletterV3ViewerEdge"}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"NewsletterV3ViewerEdge_newsletterV3ViewerEdge"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NewsletterV3ViewerEdge"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isSubscribed"}}]}}]}},11321:(e,n,i)=>{i.d(n,{h:()=>t});var a=i(39181),l=i(99766),t=function(e){var n,i=e.newsletterSlug,t=void 0===i?"":i,d=e.collectionSlug,r=void 0===d?null:d,u=e.username,s=void 0===u?null:u,o=(0,a.I)(l.k,{variables:{newsletterSlug:t,collectionSlug:r,username:s},ssr:!1,skip:!t&&!s}),m=o.loading,k=o.error,c=o.data;return m?{loading:m}:k?{error:k}:{viewerEdge:null==c||null===(n=c.newsletterV3)||void 0===n?void 0:n.viewerEdge}}},46445:(e,n,i)=>{i.d(n,{T:()=>m});var a=i(58168),l=i(80045),t=i(96540),d=i(52290),r=i(56942),u=i(36557),s=i(64314),o=["children","titleText"],m=function(e){var n,i=e.children,m=e.titleText,k=(0,l.A)(e,o),c="confirmDialogTitle",v=null!==(n=k.testId)&&void 0!==n?n:void 0;return t.createElement(s.m,(0,a.A)({},k,{ariaLabelledBy:c}),t.createElement(r.DZ,{ariaLabelledById:c,scale:{xs:"M",sm:"M",md:"L",lg:"L",xl:"L"},testId:v},m),t.createElement(d.a,{paddingTop:"6px",paddingBottom:"36px"},t.createElement(u.kZ,{scale:{xs:"M",sm:"M",md:"L",lg:"L",xl:"L"},tag:"div"},i)))}}}]);
//# sourceMappingURL=https://stats.medium.build/lite/sourcemaps/3624.bcb3363d.chunk.js.map